from bs4 import BeautifulSoup
import requests
import argparse

parser = argparse.ArgumentParser(description='Reverse the hash using hashtoolkit.com')
parser.add_argument('-H', '--hash', type=str, metavar='', help='Hash value to decrypt (MD5 or SHA1)', required=True)
args = parser.parse_args()

def hash_reverse(hash_value):
    text = ''
    url = 'https://hashtoolkit.com/decrypt-hash/?hash='
    headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36'}
    page = requests.get(url + hash_value, headers=headers)
    soup = BeautifulSoup(page.text, 'html.parser')

    try:
        if len(hash_value) == 40:
            text = soup.find('span', {'title': 'decrypted sha1 hash'}).text
        elif len(hash_value) == 32:
            text = soup.find('span', {'title': 'decrypted md5 hash'}).text
        else:
            print('Invalid hash.')         
        print('Decrypted text: ' + text)       
    except:
        print('Hash not found.')

if __name__ == '__main__':
    hash_reverse(hash_value=args.hash)
