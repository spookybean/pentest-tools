import argparse
import PyPDF2

parser = argparse.ArgumentParser(description='PDF document metadata extractor')
parser.add_argument('-f', '--file', metavar='', help='pdf file name with path', required=True)
args = parser.parse_args()

def meta_extractor(file):
    info = None

    try:
        with open(file, mode='rb') as file:
            pdf_parser = PyPDF2.PdfFileReader(file)
            info = pdf_parser.getDocumentInfo()
    except FileNotFoundError:
        print(f'File {file} does not exist.')
        exit()
    except Exception:
        print('Invalid file.')
        exit()
        
    return info

if __name__ == '__main__':
    doc_info = meta_extractor(file=args.file)
    print('\n')
    
    try:
        print(f'Metadata of file {args.file}: \n')
        for key, value in doc_info.items():
            print('{:<16}  ->  {:}'.format(key[1:], value))
    except AttributeError:
        print('No metadata found.')
