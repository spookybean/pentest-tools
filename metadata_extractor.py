import sys
import argparse

from pypdf import PdfReader


parser = argparse.ArgumentParser(description='PDF document metadata extractor')
parser.add_argument('-f', '--file', metavar='', help='pdf file name with path', required=True)

args = parser.parse_args()


def meta_extractor(file: str) -> dict:
    try:
        with open(file, mode='rb') as file:
            info = PdfReader(file).metadata
    except FileNotFoundError:
        print(f'File {file} does not exist')
    except Exception:
        print('Invalid file')
    else:
        return info


if __name__ == '__main__':
    info = meta_extractor(file=args.file)
    print(info)
