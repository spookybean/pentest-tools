import sys
import argparse

import httpx


parser = argparse.ArgumentParser(description='Missing website security headers')
parser.add_argument('-u', '--url', metavar='', help='website url', required=True)

args = parser.parse_args()

security_headers = {
    'x-frame-options',
    'x-xss-protection',
    'x-content-type-options',
    'referrer-policy',
    'content-type',
    'set-cookie',
    'strict-transport-security',
    'access-control-allow-origin',
    'cross-origin-opener-policy',
    'cross-origin-embedder-policy',
    'cross-origin-resource-policy',
    'permissions-policy'
}


def scanner(url: str) -> list[str]:
    headers = {
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36'
    }

    res = httpx.get(url, headers=headers)

    return security_headers - set(res.headers.keys())


if __name__ == '__main__':
    missing = scanner(args.url)
    print(missing)
